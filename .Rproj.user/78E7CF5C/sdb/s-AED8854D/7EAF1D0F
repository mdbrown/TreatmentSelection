{
    "collab_server" : "",
    "contents" : "\nSIM.data.singleMarker <- \n  function(nn,\n           mu = 0, \n           Sigma = 1, \n           beta = log(3),\n           beta2 = log(.5), \n           beta3 = log(2), \n           lam0 = .1, \n           cens.lam = 0, \n           time.max = 5)\n  {\n    \n    Y <- rnorm(nn, mu, Sigma)\n    trt <- rbinom(nn, size = 1, prob = .5)\n    \n    mu.i <- Y*beta + trt*beta2 + Y*trt*beta3\n    \n    #true survival time\n    r.ti <- log(-log(runif(nn)))\n    ti <-  -mu.i + r.ti\n    ti <- exp(ti)/lam0\n    \n    \n    \n    #time.max is the followup time. \n    ci = rep(time.max, nn)\n    \n    \n    if(cens.lam > 0){\n      ci = rexp(nn, rate = cens.lam)     \n    }\n    \n    \n    ci = pmin(ci, time.max)\n    \n    \n    #observed marker is the min of ti and ci        \n    xi <- pmin(ti, ci)\n    # failure indicator\n    di <- ifelse( ti == xi, 1, 0)\n    \n    #xi is the min of ti and ci\n    #di is the indicator for failure, 1 for failure, 0 for censored\n    #Y is the marker values\n    \n    result <- as.data.frame(cbind(xi, di, Y, trt)) \n    names(result) = c( \"xi\", \"di\", \"Y\", \"trt\")\n    return(result)\n  }\n\n\nsurv_tsdata <- SIM.data.singleMarker(1000)\n\nts_surv <- trtsel(Surv(time = xi, event = di)~Y*trt,\n                  treatment.name = \"trt\", \n                  prediction.time = 1, \n                  data = surv_tsdata)\n\nplot(ts_surv, bootstraps = 50)\ncalibrate(ts_surv, plot.type = \"risk.t1\")\n\nTreatmentSelection::evaluate(ts_surv, bootstraps = 50)\n\nTreatmentSelection::evaluate(ts_surv, bootstraps = 50,bias.correct = FALSE)\n",
    "created" : 1474858704835.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4179252611",
    "id" : "7EAF1D0F",
    "lastKnownWriteTime" : 1474489723,
    "last_content_update" : 1474489723,
    "path" : "~/TreatmentSelection/inst/check.R",
    "project_path" : "inst/check.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}