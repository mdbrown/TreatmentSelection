get.summary.measures.cohort <-
function(data, rho, d=0){  


  event <- data$event
  trt <- data$trt
  trt.effect <- data$trt.effect

  neg <- data$marker.neg
  pos <- 1 - neg

    #proportion marker negative
    p.marker.neg <- mean(neg)

    #Average Benefit (B) of no treatment among marker negatives...
 
    #empirical estimate
    B.neg.emp <- ifelse(length(event[trt==0 & neg==1]) > 0 & length(event[trt==1 & neg==1]) > 0, 
                        (mean(event[trt==1 & neg==1]) - mean(event[trt==0 & neg==1])) ,
                       0)

    #model based estimate
    B.neg.mod <- ifelse(sum(neg) >0, -mean(trt.effect[neg==1]), 0)
 
    #Average Benefit (B) of treatment among marker positives...
 
    #empirical estimate
    B.pos.emp <- ifelse(length(event[trt==0 & pos==1]) > 0 & length(event[trt==1 & pos==1]) > 0, 
                        mean(event[trt==0 & pos==1]) - mean(event[trt==1 & pos==1]), 
                       0)

    #model based estimate
    B.pos.mod <- ifelse(sum(pos)>0, mean(trt.effect[pos==1]), 0)

    #Theta
    Theta.emp <- B.neg.emp*p.marker.neg
    Theta.mod <- B.neg.mod*p.marker.neg

    p0.hat <- mean(event[trt==0])
    p1.hat <- mean(event[trt==1])
    Var.Delta <- mean((trt.effect - (p0.hat - p1.hat))^2)

    delta.F <- get.F.cohort( trt.effect, event, trt, rho = NULL)
    
    ooo <- order(trt.effect)

    s.delta.F <- delta.F[ooo]

    
    TG <- sum( diff(c(0, s.delta.F))*abs( sort(trt.effect) - (p0.hat - p1.hat))) 
    


  list(     p.neg = p.marker.neg, 
        B.neg.emp = B.neg.emp,
        B.neg.mod = B.neg.mod, 
        B.pos.emp = B.pos.emp, 
        B.pos.mod = B.pos.mod, 
        Theta.emp = Theta.emp, 
        Theta.mod = Theta.mod, 
        Var.Delta = Var.Delta, 
        TG        = TG
        ) 

  

}
