print.eval.trtsel <-
function(x){
  
#if we fail to reject the null hypothesis, display a warning
  test.Null.warning(x$test.Null$reject, x$test.Null$a1a3.pval)
  alpha <- x$test.Null$alpha

  cat("\n\n")
  cat("  Hypothesis test:\n")
  cat(" ------------------\n")
  cat("  H0: No decrease in disease rate under marker-based treatment")
  cat("\n") 
  cat("                                      ")
  cat(" P value = "); cat(round(x$test.Null$p.value, 5));
  cat("\n")
  cat("                                      ")
  cat(" Z statistic = "); cat(round(x$test.Null$z.statistic, 3)); cat("\n")

  if(!is.null(x$test.Null$a1a3.pval)){
  
  cat("  H0: Treatment effect positivity threshold is outside marker bounds")
  cat("\n") 
  cat("                                      ")
  cat(" P value = "); cat(x$test.Null$a1a3.pval);
  cat("\n")

  }
cat("\n")
 
  cat(paste("  Summary Measure Estimates (with ", round(100*(1-alpha)), "% confidence intervals) \n", sep=""))
  cat(" -----------------------------------------------------------\n")

    if(is.null(x$conf.intervals)) {
  cat("   No confidence intervals calculated...returning NA for lower and upper bounds"); cat("\n\n")
   x$conf.intervals <- matrix( nrow = 2, ncol = 9)
  }

  cat("  Decrease in disease rate under marker-based treatment (Theta)\n")
  cat("    Empirical:   ")
  cat(paste(" ", round(x$estimates$Theta.emp,  3), " (",
                 round(unname(x$conf.intervals[1,6]), 3), ",",
                 round(unname(x$conf.intervals[2,6]), 3), ") ", sep = ""))
  cat("\n")
  cat("    Model Based: ")
  cat(paste(" ", round(x$estimates$Theta.mod,  3), " (",
                 round(unname(x$conf.intervals[1,7]), 3), ",",
                 round(unname(x$conf.intervals[2,7]), 3), ") ", sep = ""))
  cat("\n\n")

    cat("  Proportion marker negative:\n")
  cat(paste("   ", round(x$estimates$p.neg,      3), " (",
                   round(unname(x$conf.intervals[1,1]), 3), ",",
                   round(unname(x$conf.intervals[2,1]), 3), ") ", sep = ""))
  cat("\n\n")

  cat("  Average benefit of no treatment among marker-negatives (B.neg)\n")
  cat("    Empirical:   ")
  cat(paste(" ", round(x$estimates$B.neg.emp,  3), " (",
                 round(unname(x$conf.intervals[1,2]), 3), ",",
                 round(unname(x$conf.intervals[2,2]), 3), ") ", sep = ""))
  cat("\n")
  cat("    Model Based: ")
  cat(paste(" ", round(x$estimates$B.neg.mod,  3), " (",
                 round(unname(x$conf.intervals[1,3]), 3), ",",
                 round(unname(x$conf.intervals[2,3]), 3), ") ", sep = ""))
  cat("\n\n")


  cat("  Average benefit of treatment among marker-positives (B.pos)\n")
  cat("    Empirical:   ")
  cat(paste(" ", round(x$estimates$B.pos.emp,  3), " (",
                 round(unname(x$conf.intervals[1,4]), 3), ",",
                 round(unname(x$conf.intervals[2,4]), 3), ") ", sep = ""))
  cat("\n")
  cat("    Model Based: ")
  cat(paste(" ", round(x$estimates$B.pos.mod,  3), " (",
                 round(unname(x$conf.intervals[1,5]), 3), ",",
                 round(unname(x$conf.intervals[2,5]), 3), ") ", sep = ""))
  cat("\n\n\n")


  cat("  Variance in estimated treatment effect : \n  ")
  cat(paste("  ", round(x$estimates$Var.Delta,  3), " (",
                 round(unname(x$conf.intervals[1,8]), 3), ",",
                 round(unname(x$conf.intervals[2,8]), 3), ") ", sep = ""))
  cat("\n")
  cat("  Total Gain: \n")
  cat(paste("    ", round(x$estimates$TG,  3), " (",
                 round(unname(x$conf.intervals[1,9]), 3), ",",
                 round(unname(x$conf.intervals[2,9]), 3), ") ", sep = ""))

  cat("\n\n")
  cat("  Marker positivity threshold:  "); cat(round( x$estimates$Marker.Thresh, 3))
  cat("\n\n")
  


  
}
